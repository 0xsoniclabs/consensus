# Copyright (c) 2025 Fantom Foundation
#
# Use of this software is governed by the Business Source License included
# in the LICENSE file and at fantom.foundation/bsl11.
#
# Change Date: <TBD>
#
# On the date above, in accordance with the Business Source License, use of
# this software will be governed by the GNU Lesser General Public License v3.

# (mandatory) 
# Path to coverprofile file (output of `go test -coverprofile` command).
#
# For cases where there are many coverage profiles, such as when running 
# unit tests and integration tests separately, you can combine all those
# profiles into one. In this case, the profile should have a comma-separated list 
# of profile files, e.g., 'cover_unit.out,cover_integration.out'.
profile: cover.out

# (optional; but recommended to set) 
# When specified reported file paths will not contain local prefix in the output
local-prefix: "github.com/Fantom-foundation/Serse"

# Holds coverage thresholds percentages, values should be in range [0-100]
threshold:
  # (optional; default 0) 
  # The minimum coverage that each file should have
  file: 100

  # (optional; default 0) 
  # The minimum coverage that each package should have
  package: 100

  # (optional; default 0) 
  # The minimum total coverage project should have
  total: 100

# Holds regexp rules which will override thresholds for matched files or packages 
# using their paths.
#
# First rule from this list that matches file or package is going to apply 
# new threshold to it. If project has multiple rules that match same path, 
# override rules should be listed in order from specific to more general rules.
override:
  # Increase coverage threshold to 100% for `foo` package 
  # (default is 80, as configured above in this example)
  # - threshold: 100
  #   path: ^pkg/lib/foo$

# Holds regexp rules which will exclude matched files or packages 
# from coverage statistics
exclude:
  # Exclude files or packages matching their paths
  paths:
    - ^(.+)mock(.+)               # exclude all files with `mock` in their path
    - lib/chrono/runtime.go       # excluded due to the usage of `//go:linkname` directive
    - ^cmd/demo/                  # demo code is is not production code
    - ^cmd/simulator/             # TODO: improve simulator coverage
    - ^lib/monitoring/            # TODO: improve monitoring coverage
                                  # TODO: simulator utilities are to be located in 
                                  # different files, with appropriate tests and
                                  # full coverage. Only the main file will be allowed
                                  # to have less than 100% coverage
 
# NOTES:
# - symbol `/` in all path regexps will be replaced by current OS file path separator
#   to properly work on Windows
